import { env } from {{#if js}}"./conf/env.js"{{else}}"@/conf/env"{{/if}};
import { {{#if socket}}server{{else}}app{{/if}} } from {{#if js}}"./app.js"{{else}}"@/app"{{/if}};
{{#if useMongodb}}
import connectDB from {{#if js}}"./db/index.js"{{else}}"@/db/index"{{/if}};
{{/if}}

const port = env.PORT || 8000;

const main = async () => {
  {{#if useMongodb}}
  await connectDB();
  {{/if}}

  const serverInstance = {{#if socket}}server{{else}}app{{/if}}.listen(port, () => {
    console.log(`Server is listening on port ${port}`);
  });

  serverInstance.on("error", (error) => {
    console.error("Server failed to start:", error);
    process.exit(1);
  });
};

main().catch((error) => {
  console.error("{{#if useMongodb}}MongoDB connection failed{{else}}Server startup failed{{/if}}:", error);
  process.exit(1);
});