import { build } from 'bun';

const entrypoint = 'src/index.ts'; // You'll need to specify your main entry file

await build({
  entrypoints: [entrypoint],
  outdir: './dist', // Corresponds to "outDir": "dist"
  target: 'node',  // Target Node.js environment
  format: 'esm',   // Corresponds to "module": "ESNext"
  // Bun's built-in transpiler handles TSX/JSX and TypeScript automatically.
  // It also handles most of the module resolution ("moduleResolution": "Node").

  // The 'sourcemap' option is often useful for debugging in production:
  // sourcemap: 'external', 
  
  // To handle path aliases like "@/":
  // This is slightly more manual in Bun's built-in bundler than in Webpack/Vite:
  plugins: [
    {
      name: 'path-alias',
      setup(build) {
        build.onResolve({ filter: /^@\// }, args => {
          return { path: new URL('./src/' + args.path.slice(2), import.meta.url).pathname };
        });
      },
    },
  ],
});

console.log('Build complete!');